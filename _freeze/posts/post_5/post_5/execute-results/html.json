{
  "hash": "214b1b6b6664850b098258964a2989c5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Recent ATP Rank 1 Men Tennis Players\"\ndescription: \"How can we visualize the evolution of the ATP Rank 1 Men Tennis Players?\"\nauthor: \"João Afonso Poester-Carvalho\"\ndate: \"8/22/2024\"\n---\n\n\nHi, this time I tried to analyse some Tennis data. \nI obtained a dataset of ATP points, and turned it into a dataset of Rank 1 players and the dates they were Rank 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggalt)\nlibrary(sysfonts)\nlibrary(showtext)\n\natp <- read_csv(\"ATP_Rankings_1990-2019.csv\")\n\nfont_add_google(\"Merriweather Sans\", regular.wt = 400, family = \"merri\")\nshowtext_auto(enable = TRUE)\n```\n:::\n\n\nNow let's process the data to obtain what we want.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrank_1 <- atp %>%\n  filter(Points > 0) %>%\n  mutate(Date = lubridate::as_date(Date))  %>%\n  group_by(Date) %>%\n  slice_max(Points) %>%\n  arrange(Date) %>%\n  ungroup() %>%\n    mutate(Rank1_Change = Player != lag(Player, default = first(Player))) %>% \n    group_by(Player) %>%\n    mutate(Group = cumsum(Rank1_Change)) %>%\n    group_by(Player, Group) %>%\n    summarize(\n      First_Day = min(Date),\n      Last_Day = max(Date)\n    ) %>%\n    ungroup() %>%\n    select(-Group) \n\nrank_1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 44 × 3\n   Player          First_Day  Last_Day  \n   <chr>           <date>     <date>    \n 1 Andre Agassi    1999-07-05 1999-07-19\n 2 Andre Agassi    1999-09-13 2000-09-04\n 3 Andre Agassi    2003-04-28 2003-05-05\n 4 Andre Agassi    2003-06-16 2003-09-01\n 5 Andy Murray     2016-11-07 2017-08-14\n 6 Andy Roddick    2003-11-03 2004-01-26\n 7 Carlos Moya     1999-03-15 1999-03-22\n 8 Gustavo Kuerten 2000-12-04 2001-01-22\n 9 Gustavo Kuerten 2001-02-26 2001-03-26\n10 Gustavo Kuerten 2001-04-23 2001-11-12\n# ℹ 34 more rows\n```\n\n\n:::\n:::\n\n\n\nThese two objects will help with the plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplayers <- rank_1 %>% \n  select(Player) %>%\n  arrange(desc(Player)) %>%\n  unique() %>%\n  as.vector() %>%\n  unlist() \n\nnames <- rank_1 %>%\n  group_by(Player) %>%\n  slice_min(First_Day)\n```\n:::\n\n\nNow, we make our plot, using a Dumbell chart!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrank_1 %>%\n  ggplot() +\n    geom_dumbbell(aes(x = First_Day, xend = Last_Day, y = factor(Player, players)), size = 0.5, \n                  colour_x = \"#7bc133\", colour_xend = \"#7bc133\", fill = \"#7bc133\", colour = \"#7bc133\") +\n    geom_text(data = names, \n              aes(x = First_Day, y = factor(Player, players), label = factor(Player, players), hjust = 1.2),\n              family = \"merri\", colour = \"white\", size = 7.5) +\n    scale_x_date(expand = c(0.3,0), breaks = seq(as.Date(\"1996-01-01\"), as.Date(\"2020-01-01\"), by = \"year\"),\n                 date_labels = \"%Y\") +\n    theme_minimal() +\n    theme(axis.text.y = element_blank(),\n          axis.title.y = element_blank(),\n          panel.grid = element_blank(),\n          axis.title.x = element_blank(),\n          axis.text.x = element_text(family = \"merri\", colour = \"white\", size = 13),\n          plot.background = element_rect(fill = \"black\", colour = \"black\"),\n          plot.title = element_text(family = \"merri\", colour = \"white\", size = 25)) +\n    labs(\n      title = \"Rank 1 Men Tennis Players from 1996 to 2019\",\n      caption = \"Source: Kaggle and ATP Tour\"\n    )\n```\n\n::: {.cell-output-display}\n![](post_5_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "post_5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}